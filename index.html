<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>我的粒子主页</title>
<style>
  body{margin:0;overflow:hidden;background:#000;font-family:"Microsoft YaHei",sans-serif}
  canvas{display:block}
  #controls{position:fixed;top:20px;left:20px;background:rgba(20,20,40,.8);padding:18px 22px;border-radius:16px;backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,.15);z-index:100;color:#fff;min-width:220px}
  h3{margin:0 0 16px;text-align:center;font-size:18px}
  .item{margin:15px 0}
  label{display:block;margin-bottom:6px;font-size:14px}
  input[type=range]{width:100%;height:6px;border-radius:3px;background:#333;outline:none}
  input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:18px;height:18px;border-radius:50%;background:#ff2a6d;cursor:pointer}
  button{padding:8px 14px;margin:4px 4px 4px 0;border:none;border-radius:8px;background:#333;color:#fff;cursor:pointer;transition:.3s}
  button.active,button:hover{background:#ff2a6d;transform:translateY(-2px)}
  #countVal{font-size:14px;margin-top:4px}
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<div id="controls">
  <h3>粒子交互控制台</h3>
  <div class="item">
    <label>粒子数量 <span id="countVal">150</span></label>
    <input type="range" id="countSlider" min="30" max="400" value="150" step="10">
  </div>
  <div class="item">
    <label>移动速度</label>
    <button data-speed="0.3">慢</button>
    <button data-speed="0.8" class="active">中</button>
    <button data-speed="2">快</button>
  </div>
  <div class="item">
    <label>鼠标作用力</label>
    <button id="attractBtn" class="active">吸引</button>
    <button id="repelBtn">排斥</button>
  </div>
</div>

<script>
const CONFIG={particleCount:150,baseSpeed:0.8,particleSize:3,lineMaxDistance:150,mouseRadius:120,mouseForce:60,colors:['#ff2a6d','#05d9e8','#ff9f1c','#a0d468','#4ecdc4']};
const canvas=document.getElementById('canvas'),ctx=canvas.getContext('2d');
let w,h,mouseX,mouseY;
function resize(){w=canvas.width=innerWidth;h=canvas.height=innerHeight}resize();
addEventListener('resize',resize);

class Particle{
  constructor(x=Math.random()*w,y=Math.random()*h){
    this.x=x;this.y=y;
    this.vx=(Math.random()-0.5)*CONFIG.baseSpeed;
    this.vy=(Math.random()-0.5)*CONFIG.baseSpeed;
    this.color=CONFIG.colors[~~(Math.random()*CONFIG.colors.length)];
    this.size=Math.random()*CONFIG.particleSize+1;
  }
  update(){
    if(mouseX!==undefined){
      const dx=this.x-mouseX,dy=this.y-mouseY,dist=Math.hypot(dx,dy);
      if(dist<CONFIG.mouseRadius&&dist>0){
        const f=CONFIG.mouseForce*(1-dist/CONFIG.mouseRadius);
        this.vx+=dx/dist*f*0.04;
        this.vy+=dy/dist*f*0.04;
      }
    }
    this.x=(this.x+this.vx+w)%w;
    this.y=(this.y+this.vy+h)%h;
  }
  draw(){
    ctx.beginPath();
    ctx.arc(this.x,this.y,this.size,0,Math.PI*2);
    ctx.fillStyle=this.color;
    ctx.fill();
  }
}
const particles=[];
function createParticles(n){particles.length=0;for(let i=0;i<n;i++)particles.push(new Particle())}
createParticles(CONFIG.particleCount);

addEventListener('mousemove',e=>{mouseX=e.clientX;mouseY=e.clientY});
canvas.addEventListener('click',e=>{
  for(let i=0;i<30;i++){
    const p=new Particle(e.clientX,e.clientY);
    const a=Math.random()*Math.PI*2,s=Math.random()*10+6;
    p.vx=Math.cos(a)*s;p.vy=Math.sin(a)*s;
    particles.push(p);
  }
});

function connect(){
  for(let i=0;i<particles.length;i++)for(let j=i+1;j<particles.length;j++){
    const dx=particles[i].x-particles[j].x,dy=particles[i].y-particles[j].y,d=Math.hypot(dx,dy);
    if(d<CONFIG.lineMaxDistance){
      ctx.beginPath();ctx.moveTo(particles[i].x,particles[i].y);ctx.lineTo(particles[j].x,particles[j].y);
      ctx.strokeStyle=`rgba(100,200,255,${1-d/CONFIG.lineMaxDistance})`;
      ctx.lineWidth=1;ctx.stroke();
    }
  }
}

function animate(){
  ctx.fillStyle='rgba(0,0,0,0.08)';ctx.fillRect(0,0,w,h);
  particles.forEach(p=>{p.update();p.draw()});
  connect();
  if(particles.length>800)particles.splice(0,particles.length-800);
  requestAnimationFrame(animate);
}
animate();

// 控制面板
document.getElementById('countSlider').addEventListener('input',e=>{
  const v=+e.target.value;CONFIG.particleCount=v;document.getElementById('countVal').textContent=v;createParticles(v);
});
document.querySelectorAll('[data-speed]').forEach(b=>b.addEventListener('click',()=>{
  document.querySelectorAll('[data-speed]').forEach(x=>x.classList.remove('active'));b.classList.add('active');
  CONFIG.baseSpeed=+b.dataset.speed;
  particles.forEach(p=>{const s=Math.hypot(p.vx,p.vy);if(s>0){p.vx=p.vx/s*CONFIG.baseSpeed;p.vy=p.vy/s*CONFIG.baseSpeed}});
}));
document.getElementById('attractBtn').addEventListener('click',()=>{CONFIG.mouseForce=60;attractBtn.classList.add('active');repelBtn.classList.remove('active')});
document.getElementById('repelBtn').addEventListener('click',()=>{CONFIG.mouseForce=-100;repelBtn.classList.add('active');attractBtn.classList.remove('active')});
</script>
</body>
</html>
